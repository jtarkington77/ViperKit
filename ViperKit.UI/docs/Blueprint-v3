1. What â€œcase focusâ€ actually is

Think of case focus as a global list of tags for this investigation, not a single string.

Examples of focus items you might accumulate during a case:

ConnectWiseControl.Client.exe

ScreenConnect Client

LogMeIn

powershell.exe

C:\Program Files\EasyHelp\agent.exe

Those get added over time from any tab:

From Hunt: you find ConnectWiseControl.Client.exe â†’ â€œAdd to focusâ€.

From Sweep: you see a folder C:\ProgramData\ScreenConnect Client (a776dâ€¦) created at the same time â†’ â€œAdd to focusâ€.

From Persist: you see a sketchy autorun â†’ â€œAdd to focusâ€.

Behind the scenes, CaseManager is holding a list like:

FocusTargets = [
  "ConnectWiseControl",
  "LogMeIn",
  "EasyHelp"
]


ğŸ”‘ Key point: Focus is additive for the whole case. New finds from Hunt/Sweep/Persist get appended; nothing gets blown away unless you start a new case or explicitly clear them.

2. How filtering should work in Persist (the part thatâ€™s pissing you off)

Persist must always be able to:

Show all persistence for the machine.

Show only items related to focus.

Show only items for a specific tool (e.g., just ConnectWise, just LogMeIn).

Show items for any of the focus tools combined (ConnectWise + LogMeIn + EasyHelp, etc.).

So Persist gets its own Focus dropdown (in addition to the existing filters):

Focus filter dropdown (Persist tab)
Options:

All items (ignore focus)

Any focus target (union of everything in the focus list)

One entry per focus item, e.g.:

ConnectWiseControl

LogMeIn

EasyHelp

How that behaves

Assume youâ€™ve got 692 persistence entries total.

Mode 1 â€“ All items (ignore focus)

Persist shows all 692 entries, filtered only by:

CHECK only checkbox

Location filter

Risk filter

Text search

Case focus is not applied at all in this mode.

Mode 2 â€“ Any focus target

Start from those 692 (after the normal filters).

Keep entries where Name / Path / RegistryPath / Source / LocationType contains any of the focus strings.

If that yields matches â†’ show them.

If that yields zero:

You still show the normal filtered results (so youâ€™re not staring at a blank list).

Status bar says something like:

Status: no persistence entries matched current focus; showing all filtered results.

Case log gets an event â€œPersist â€“ no entries matched focus (ConnectWise, LogMeIn, â€¦)â€.

Mode 3 â€“ Single focus target (e.g. â€œConnectWiseControlâ€)

Same idea, but only for that one string.

You can flip between:

All items

Any focus target

ConnectWiseControl

LogMeIn

etc.

If single-focus filter yields zero:

Again, you fall back to showing the normal filtered list, not an empty screen.

Status text:

Status: no persistence entries for focus â€œConnectWiseControlâ€; showing all filtered results.

ğŸ”‘ Key point:

Persist always shows something unless the base filters themselves produce zero.

Focus never silently nukes the list. Itâ€™s a â€œtry to narrow to this; if nothing, tell me and show everything anywayâ€ filter.

3. How you add focus items over time (the workflow you described)
Step 1 â€“ Hunt

Run Hunt on ScreenConnect.Client.exe, ConnectWiseControl.Client.exe, etc.

You see your hits in the Hunt tab.

You click â€œSet case focusâ€ / â€œAdd to focusâ€ on a hit.

CaseManager.FocusTargets now contains "ConnectWiseControl.Client.exe" (or a cleaned-up token like "ConnectWiseControl").

Step 2 â€“ Persist (first pass)

Go to Persist.

Run Persist â†’ it always scans all known persistence locations (Run keys, Startup, Services, Tasks, Winlogon, IFEO, AppInit).

Set Focus filter to:

Any focus target OR

ConnectWiseControl specifically.

If there is persistence for that tool:

You see only those entries (plus any other normal filters you choose).

If there is no persistence for that tool:

You get:

Status: No persistence entries matched this focus; showing all filtered results.

A populated list, so you can still see everything else.

This is where your â€œno persistence found â€“ go run Sweepâ€ hint comes in.

Step 3 â€“ Sweep (finding related stuff by time / artifacts)

Run Sweep around the time of infection.

You see:

New folders

Recently touched EXEs

ProgramData directories

etc.

When you see something suspicious that looks tied to the incident (e.g. C:\ProgramData\ScreenConnect Client (8aefâ€¦), some weird EXE in AppData):

Click â€œAdd to focusâ€ on those items.

CaseManager.FocusTargets now might be:

[
  "ConnectWiseControl",
  "ScreenConnect Client (8aefâ€¦)",
  "some-suspicious-folder"
]

Step 4 â€“ Persist (second pass with new focus)

Back to Persist:

Focus filter = Any focus target â†’ see anything tied to any of those artifacts.

Or pick one specific one from the dropdown to isolate it:

ConnectWiseControl

ScreenConnect Client (8aefâ€¦)

If still nothing for those â†’ explicit status message + log that â€œno persistence entries match the current focusâ€.

ğŸ”‘ Key point:
You donâ€™t lose previously added focus items. You can keep stacking:

ConnectWise

LogMeIn

EasyHelp
etc., and flip between:

Just ConnectWise

Just LogMeIn

All focus items combined

Or â€œAll itemsâ€ to ignore focus completely.

4. What about multiple tools on the same box?

Your example:

â€œif there is connectwise and logmein i should be able to filter by just connectwise, just logmein, both of them, or the same way we have filter now if i want to look at all items.â€

With the design above:

All items (ignore focus) = â€œshow everything, like todayâ€.

Any focus target = â€œshow both ConnectWise + LogMeIn + any other focused toolsâ€.

ConnectWise = â€œjust ConnectWiseâ€.

LogMeIn = â€œjust LogMeInâ€.

So you get exactly those four views:

All entries.

Only entries for any focus tool (union).

Only entries for ConnectWise.

Only entries for LogMeIn.

5. Tying it to your â€œreal worldâ€ workflow

â€œTHINK OF THE FUCKING WORKFLOW OF CLEANING A FUCKING MACHINEâ€¦â€

This is what the final behavior supports:

Hunt: find obviously-bad binaries / folders / processes â†’ add focus.

Persist: see which of those have true persistence entries (services, autoruns, scheduled tasks, Winlogon, IFEO, etc.).

If none â†’ UI tells you that and suggests you run Sweep.

Sweep: look for â€œsiblingâ€ artifacts:

Same timestamp windows.

Same parent directories.

Other EXEs/DLLs created at same time.

Add those to focus.

Back to Persist: now youâ€™re hunting for persistence tied to the ripple of that infection, not just the original binary.

Once youâ€™re satisfied youâ€™ve killed persistence, you can log everything out of the case and move to Cleanup.

If this behavior matches what youâ€™ve got in your head:

Next step Iâ€™ll give you very small, surgical changes:

CaseManager: add a list of focus targets instead of a single string, plus AddFocusTarget, GetFocusTargets, and ClearFocusTargets.

Hunt / Sweep / Persist: change â€œSet case focusâ€ to append instead of overwrite.

Persist: wire a Focus dropdown that uses those targets, with the exact fallback behavior described above.

No guessing, no â€œlook for a method that doesnâ€™t existâ€ crap â€” literally â€œpaste this block under Xâ€, â€œreplace method Y with this exact textâ€, step by step.

But the big question first is just: does this match